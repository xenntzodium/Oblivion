# exploitscanner.py

import subprocess

def search_exploits(services, output_file):
    print("[BİLGİ] Exploit-DB aramaları yapılıyor...")
    found_exploits = []

    for service in services:
        try:
            result = subprocess.run(["searchsploit", service], capture_output=True, text=True)
            found_exploits.append(f"### {service} ###\n{result.stdout}")
        except Exception as e:
            print(f"[HATA] SearchSploit çalıştırılamadı: {e}")

    with open(output_file, "w") as file:
        file.write("\n\n".join(found_exploits))

    print(f"[BİLGİ] Exploit araştırma sonuçları {output_file} dosyasına kaydedildi.")
